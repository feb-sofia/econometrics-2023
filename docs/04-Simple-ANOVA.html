<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to linear regression analysis - 5&nbsp; Simple ANOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-Hypothesis-Testing-and-CI.html" rel="next">
<link href="./03-Simple-Linear-Model.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Simple ANOVA</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to linear regression analysis</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Setup</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-Recommended-Literature.html" class="sidebar-item-text sidebar-link">Recommended reading</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-Homework-Instructions.html" class="sidebar-item-text sidebar-link">Homework (not graded)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Statistics-Review.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Statistics Review (Optional)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Introduction-to-R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02a-Continuous-Distributions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Continuous Distributions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-Simple-Linear-Model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Simple Linear Model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-Simple-ANOVA.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Simple ANOVA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-Hypothesis-Testing-and-CI.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">A Simulation Study</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-data" id="toc-the-data" class="nav-link active" data-scroll-target="#the-data"><span class="toc-section-number">5.1</span>  The Data</a></li>
  <li><a href="#the-linear-regression-model-with-a-single-binary-predictor" id="toc-the-linear-regression-model-with-a-single-binary-predictor" class="nav-link" data-scroll-target="#the-linear-regression-model-with-a-single-binary-predictor"><span class="toc-section-number">5.2</span>  The Linear Regression Model with a single binary predictor</a></li>
  <li><a href="#mathematical-details-optional" id="toc-mathematical-details-optional" class="nav-link" data-scroll-target="#mathematical-details-optional"><span class="toc-section-number">5.3</span>  Mathematical Details (Optional)</a>
  <ul class="collapse">
  <li><a href="#the-ols-estimator-in-the-binary-predictor-case" id="toc-the-ols-estimator-in-the-binary-predictor-case" class="nav-link" data-scroll-target="#the-ols-estimator-in-the-binary-predictor-case"><span class="toc-section-number">5.3.1</span>  The OLS Estimator in the Binary Predictor Case</a></li>
  <li><a href="#what-about-the-standard-errrors" id="toc-what-about-the-standard-errrors" class="nav-link" data-scroll-target="#what-about-the-standard-errrors"><span class="toc-section-number">5.3.2</span>  What about the standard errrors?</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-simple-anova" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Simple ANOVA</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="the-data" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="the-data"><span class="header-section-number">5.1</span> The Data</h2>
<p>Variables description:</p>
<ul>
<li><code>kid_score</code>: (numeric) Kid’s IQ score.</li>
<li><code>mom_hs</code> (numeric): This variable has only two possible values (a binary variable): 1 if the mother of the child has finished high school, and 0 otherwise.</li>
</ul>
<p>For the sake of simplicity we will assume that the children in the sample (in the data set <code>kids</code>) were selected at random from all children living in the US at the time of the survey.</p>
<p>Research question: Do children whose mother did not finish a high school (<code>mom_hs = 0</code>) tend to achieve lower IQ scores compared to the children of mothers with a high school degree (<code>mom_hs = 1</code>).</p>
</section>
<section id="the-linear-regression-model-with-a-single-binary-predictor" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="the-linear-regression-model-with-a-single-binary-predictor"><span class="header-section-number">5.2</span> The Linear Regression Model with a single binary predictor</h2>
<p>Let us first summarize the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>kids <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Group the data according to the educational status of the mothers</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mom_hs) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Compute the average IQ score in each group</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="do">## The function n() counts the number of rows (children) in each group</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Compute the average IQ score for each group</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Average_IQ_score =</span> <span class="fu">mean</span>(kid_score)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-kids-summary" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;5.1: Average IQ scores and number of observations (n) by the status of the mother.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">mom_hs</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Average_IQ_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">77.54839</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">341</td>
<td style="text-align: right;">89.31965</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Where to get the data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>kids <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Map the status of the mother to the y-axis.</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>      <span class="do">## The factor function converts mom_hs to a factor variable</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>      <span class="do">## so that ggplot would not treat mom_hs as a continuous variable.</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">factor</span>(mom_hs),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Map the kid_score column to the x-axis.</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> kid_score</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Add some noise to each observation so that we can </span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="do">## see the collection of dots. Without this noise</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="do">## all dots would lie on two straight lines</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"jitter"</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Draws the two boxplots to help us see the centers and the spreads</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="do">## of the distributions of the scores in the two groups</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Makes the boxplots transparent so that we can see the dots</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="do">## behind them</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Sets human-readable labels for the two axes</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"IQ score"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Status of the kid's mother"</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-kid-score-plot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-Simple-ANOVA_files/figure-html/fig-kid-score-plot-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.1: IQ scores of the children by the status of their mother (high school degree/no high school degree). The plot adds a small random noise to the observations to avoid overplotting.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Let us see how we can model the average IQ scores within a simple linear model.</p>
<p><span class="math display">
\begin{align*}
&amp; i = 1,\ldots, n = 434 \text{ observations}\\
&amp; y_i: \text{Kid IQ score} \\
&amp; x_i \in \{0, 1\}: \text{status of the mother}
\end{align*}
</span></p>
<p>The linear model is then</p>
<p><span class="math display">
y_i = \beta_0 + \beta_1 x_i + e_i, e_i \sim N(0, \sigma^2)
</span> Alternatively (and more generally) we can write the model (see <a href="03-Simple-Linear-Model.html"><span>Chapter&nbsp;4</span></a>) as:</p>
<p><span id="eq-simple-anova"><span class="math display">
\begin{align*}
&amp; y_i \sim N(\mu_i, \sigma^2), \quad i = 1,\ldots,n \\
&amp; \mu_i = \beta_0 + \beta_1 x_i, \quad x_i \in \{0, 1\}
\end{align*}
\tag{5.1}</span></span></p>
<p>Let us see what the model coefficients mean. This becomes obvious when we consider the expected value of <span class="math inline">y</span> (the IQ score) for the two possible values of <span class="math inline">x</span>. For <span class="math inline">x = 1</span> (children with a mother with a HS degree) the expected IQ score is:</p>
<p><span id="eq-mu-x-1"><span class="math display">
\mu_1 = \beta_0 + \beta_1 \cdot 1
\tag{5.2}</span></span></p>
<p>For <span class="math inline">x = 0</span> (children with a mother without a HS degree)</p>
<p><span id="eq-mu-x-0"><span class="math display">
\mu_0 = \beta_0 + \beta_1 \cdot 0
\tag{5.3}</span></span></p>
<p>If you take the difference between equations <a href="#eq-mu-x-1"><span>5.2</span></a> and <a href="#eq-mu-x-0"><span>5.3</span></a> you will get:</p>
<p><span class="math display">
\begin{align*}
\beta_0 &amp; = \mu_0 \\
\beta_1 &amp; = \mu_1 - \mu_0
\end{align*}
</span> Therefore, the constant in the model (<span class="math inline">\beta_0</span>) equals the population average IQ score of children in the <span class="math inline">x = 0</span> group. The slope coefficient <span class="math inline">\beta_1</span> equals the difference between the population average IQ scores. <a href="#fig-simple-anova-model-vis">Figure&nbsp;<span>5.2</span></a> visualizes the population of children (as the model in <a href="#eq-simple-anova">Equation&nbsp;<span>5.1</span></a> sees it). There are two groups of children in that population. The first has an average IQ score of <span class="math inline">\mu_0</span>, the second group has an average IQ score of <span class="math inline">\mu_1</span>. The children in both groups are normally distributed and the two distributions have the same standard deviation (spread).</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Scale for x is already present.
Adding another scale for x, which will replace the existing scale.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-simple-anova-model-vis" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-Simple-ANOVA_files/figure-html/fig-simple-anova-model-vis-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.2: Distribution of IQ scores in the population of children according to <a href="#eq-simple-anova">Equation&nbsp;<span>5.1</span></a>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Within that model our research question boils down to examining <span class="math inline">\beta_1</span> (the difference between the population averages). If <span class="math inline">\beta_1</span> is positive, then children born to a mother with a HS degree would tend to perform better at the IQ test.</p>
<p>The first obstacle to answering the research question is that we don’t know the value of <span class="math inline">\beta_1</span>. Therefore, we would need to rely on the sample to learn something about the value of <span class="math inline">\beta_1</span>.</p>
<p>In the previous section we discussed the OLS estimator and now we will use it to find the best (in terms of lowest RSS) estimates for <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span>. As in the previous section will will find these using the <code>lm</code> function. We will also store the result of <code>lm</code> in an object so that we can use it later without running <code>lm</code> every time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Run lm and save the output in an object called "fit"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(kid_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> mom_hs, <span class="at">data =</span> kids)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Print the object storing the lm output</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = kid_score ~ 1 + mom_hs, data = kids)

Coefficients:
(Intercept)       mom_hs  
      77.55        11.77  </code></pre>
</div>
</div>
<p>Look at the output of <code>lm</code> and write down the estimated regression equation:</p>
<p><span class="math display">
\begin{align*}
\hat{\mu} = 77.55 + 11.77 x
\end{align*}
</span></p>
<p>This equation summarizes the <em>sample</em>. The children that we have selected and actually observed. For these children there was a difference of average IQ scores of 11.77. However, the sample only includes 434 children. A more interesting question is whether there is a difference between the average IQ scores between the two groups (mother with HS degree, mother without HS degree) in the <em>population</em> from which the sample was selected.</p>
<p>An interesting research hypothesis that we can test is whether the <em>population</em> coefficient <span class="math inline">\beta_1</span> is equal to zero, for example against a two-sided alternative <span class="math inline">\beta_1 \neq 0</span>.</p>
<p><span class="math display">
H_0: \beta_1 = 0 \\
H_1: \beta_1 \neq 0
</span> A test of this hypothesis against the alternative is a t-test with a test statistic</p>
<p><span class="math display">
\text{t-statistic} = \frac{\hat{\beta}_1 - 0}{se(\hat{\beta}_1)}
</span></p>
<p>If <span class="math inline">\beta_1</span> is really equal to zero, then this statistic follows a t-distribution with <span class="math inline">n - p</span> degrees of freedom. The critical values of this test at <span class="math inline">\alpha = 0.05</span> probability of wrong rejection of the null hypothesis.</p>
<p>For the <code>kids</code> data set you can test this hypothesis using the output of <code>summary</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = kid_score ~ 1 + mom_hs, data = kids)

Residuals:
   Min     1Q Median     3Q    Max 
-57.55 -13.32   2.68  14.68  58.45 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   77.548      2.059  37.670  &lt; 2e-16 ***
mom_hs        11.771      2.322   5.069 5.96e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19.85 on 432 degrees of freedom
Multiple R-squared:  0.05613,   Adjusted R-squared:  0.05394 
F-statistic: 25.69 on 1 and 432 DF,  p-value: 5.957e-07</code></pre>
</div>
</div>
<p>The second row in the coefficients table corresponds to our <span class="math inline">\hat{\beta}_1</span> in our model notation (the coefficient of <code>mom_hs</code>). You can find the estimated standard error of <span class="math inline">\hat{\beta}_1</span> in the second column (<code>Std. Error</code>).</p>
<p><span class="math display">
\text{t-statistic}^{obs} = \frac{11.77 - 0}{2.322} = 5.0689
</span></p>
<p>You can find this value in the column <code>t value</code> in the <code>summary</code> above. This t-statistic is shown in the regression output by almost all statistical software, because the hypothesis</p>
<p><span class="math display">
H_0: \beta_1 = 0 \\
H_1: \beta_1 \neq 0
</span> is particularly interesting. If true it implies that there are no population-level differences between the average IQ scores of the two groups of children.</p>
<p>In order to make a decision whether to reject this hypothesis or not, we compare the observed t-statistic to two critical values (because the alternative is two-sided).</p>
<p>The critical values at a five percent error probability (wrong rejection of a true null hypothesis) are derived from the t-distribution. You can find a detailed explanation in <a href="05-Hypothesis-Testing-and-CI.html"><span>Chapter&nbsp;6</span></a>.</p>
<p>The quantiles of the t-distribution are</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> <span class="fu">nrow</span>(kids) <span class="sc">-</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.965471</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> <span class="fu">nrow</span>(kids) <span class="sc">-</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.965471</code></pre>
</div>
</div>
<p>The observed t-statistic equals 5.0689 and is therefore greater than the upper critical value (1.96). Therefore we reject the null hypothesis at a significance level <span class="math inline">1 - \alpha = 0.95</span> (this is another way to state the probability of wrong rejection of a true null hypothesis).</p>
<p>Apart from the point estimate for the difference of average IQ scores (11.77 points) we usually also want to communicate the uncertainty of this estimate. One description of that uncertainty is the (estimated) standard error of the estimator for the regression coefficient.</p>
<p>One way to construct a confidence interval for the coefficients is to invert the two-sided t-test (see <a href="05-Hypothesis-Testing-and-CI.html#sec-sim-ci"><span>Section&nbsp;6.7</span></a> for more details).</p>
<p>We will use the critical values of the t-test at the 95 percent significance level to obtain an confidence interval (CI) with a 95 percent coverage probability:</p>
<p><span id="eq-ci-kids-beta1"><span class="math display">
P\left(\hat{\beta}_1 - 1.96 se(\hat{\beta}_1)  &lt; \beta_1 &lt; \hat{\beta}_1 + 1.96 se(\hat{\beta}_1) \right) = 0.95
\tag{5.4}</span></span></p>
<p>Notice that the boundaries of the interval are random variables (because <span class="math inline">\hat{\beta}_1</span> and <span class="math inline">se(\hat{\beta}_1)</span>) are random variables (they depend on the data). For the sample of children in <code>kids</code> we obtain <em>estimates</em> for these boundaries: <span class="math inline">[11.77 - 1.96 \cdot 2.322; 11.77 + 1.96 \cdot 2.322] \approx [7.2; 16.3]</span>. Based on these estimated boundaries we would say that range of plausible values for the difference between the population IQ score averages between 7.2 and 16.3.</p>
<p>Notice that in interpreting the boundaries of the CI we don’t say that the probability of <span class="math inline">\beta_1</span> being between 7.2 and 16.3 is 0.95. Generally this statement does not make any sense, because we have assumed that <span class="math inline">\beta_1</span> is a fixed number (not random). The probability statement in <a href="#eq-ci-kids-beta1">Equation&nbsp;<span>5.4</span></a> does make sense, because the boundaries are random variables (depend on the data), but the statement <span class="math inline">P(7.2 &lt; \beta_1 &lt; 16.3) = 0.95</span> does not!</p>
</section>
<section id="mathematical-details-optional" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="mathematical-details-optional"><span class="header-section-number">5.3</span> Mathematical Details (Optional)</h2>
<section id="the-ols-estimator-in-the-binary-predictor-case" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="the-ols-estimator-in-the-binary-predictor-case"><span class="header-section-number">5.3.1</span> The OLS Estimator in the Binary Predictor Case</h3>
<p>In the case when <span class="math inline">x_i \in \{0, 1\}</span> the average of <span class="math inline">x</span>, i.e <span class="math inline">\overline{x}</span> is simply the proportion of ones, lets say <span class="math inline">n_1 / n</span>. Notice that the average of the squared <span class="math inline">x</span> is the same as the average of <span class="math inline">x</span>, because <span class="math inline">x</span> only contains zeroes and ones (therefore <span class="math inline">x_i^2 = x_i</span>). The average of the product of <span class="math inline">x</span> and <span class="math inline">y</span> is equal to the sum of <span class="math inline">y</span> where the <span class="math inline">x = 1</span>, because the other values in <span class="math inline">y</span> are multiplied by zero.</p>
<p><span class="math display">
\begin{align*}
\overline{x^2} = &amp; \frac{1}{n}\sum_{i = 1}^{n} x_i^2 =  \\
               = &amp; \frac{1}{n} \sum_{i = 1}^n x_i \\
               = &amp; \bar{x}
\end{align*}
</span></p>
<p><span class="math display">
\begin{align*}
\overline{xy} = &amp; \frac{1}{n} \sum_{i = 1}^{n} x_i y_i = \\
              = &amp; \frac{1}{n}\left(\sum_{i: x_i = 0} y_i \cdot 0 + \sum_{ i: x_i = 1} y_i \cdot 1 \right) \\
              = &amp; \frac{1}{n}\sum_{i: x_i = 1} y_i \\
              = &amp; \frac{n_1}{n_1}\frac{1}{n} \sum_{i: x_i = 1} y_i \\
              = &amp; \frac{n_1}{n} \bar{y}_{1}
\end{align*}
</span></p>
<p>In the last expression we use <span class="math inline">\bar{y}_1</span> to denote the sample average of the <span class="math inline">x = 1</span> group.</p>
<p>Therefore the expression for <span class="math inline">\hat{\beta}_1</span> simplifies to:</p>
<p><span class="math display">
\hat{\beta}_1 = \frac{ \frac{n_1}{n} \overline{y}_{1} - \overline{x}\overline{y}}{\overline{x} - \overline{x}^2} \\
\hat{\beta}_1 = \frac{\overline{y}_{1} - \overline{y}}{1 - \frac{n_1}{n}} \\
\hat{\beta}_1 = \frac{\overline{y}_{1} - \overline{y}}{\frac{n - n_1}{n}} \\
\hat{\beta}_1 = \frac{\overline{y}_{1} - \overline{y}}{\frac{n_0}{n}} \\
</span></p>
<p>Furthermore, the average of <span class="math inline">y</span> is simply the weighted average of the two group means. Let there be <span class="math inline">n_0</span> observations with <span class="math inline">x_i = 0</span> and <span class="math inline">n_1</span> observations with <span class="math inline">x_i = 1</span>.</p>
<p><span class="math display">
\overline{y} = \frac{1}{n}\left(\sum_{x_i = 0} y_i + \sum_{x_i = 0} y_i\right) \\
\overline{y} = \frac{1}{n}\left(n_0 \overline{y}_0 + n_1 \overline{y}_1 \right)
</span></p>
<p>Substituting gives us:</p>
<p><span class="math display">
\hat{\beta}_1 = \frac{\overline{y}_{1} - \frac{1}{n}\left(n_0 \overline{y}_0 + n_1 \overline{y}_1 \right)}{\frac{n_0}{n}} \\
</span></p>
<p>When you simplify the above expression (this is left as an exercise) you will arrive at:</p>
<p><span class="math display">
\hat{\beta}_1 = \bar{y}_1 - \bar{y}_0
</span></p>
<p>From the equation for <span class="math inline">\hat{\beta}_0</span> we get:</p>
<p><span class="math display">
\hat{\beta}_0 = \bar{y} - (\bar{y}_1 - \bar{y}_0) \bar{x}
</span></p>
<p>Taking into account that <span class="math inline">\bar{x} = n_1 / n</span> this equation simplifies to</p>
<p><span class="math display">
\hat{\beta}_0 = \overline{y}_0
</span></p>
</section>
<section id="what-about-the-standard-errrors" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="what-about-the-standard-errrors"><span class="header-section-number">5.3.2</span> What about the standard errrors?</h3>
<p>In the case of the simple ANOVA model the standard errors of both coefficients are pretty easy to derive, because the estimators are simply a group average (<span class="math inline">\hat{\beta}_0</span>) and the difference between two group averages (<span class="math inline">\hat{\beta}_1</span>).</p>
<p>We can compute the variance of <span class="math inline">\hat{beta}_0</span>. Note that when studying the statistical properties of an estimator like the OLS estimator for <span class="math inline">\beta_0</span> we treat the data <span class="math inline">y_i</span> as random variables. In the following derivation we assume that the <span class="math inline">y_i</span> are not correlated.</p>
<p><span id="eq-simple-anova-var-beta0"><span class="math display">
\begin{align*}
Var(\hat{\beta}_0) &amp; = Var\left(\frac{1}{n_0}\sum_{i: x_i = 0} y_i \right) \\
                   &amp; = \frac{1}{n_0^2} \sum_{i: x_i = 0} Var(y_i) \\
                   &amp; = \frac{1}{n_0^2} \sum_{i: x_i = 0} \sigma^2 \\
                   &amp; = \frac{n_0 \sigma^2}{n_0^2} \\
                   &amp; = \frac{\sigma^2}{n_0}
\end{align*}
\tag{5.5}</span></span></p>
<p>For the variance of <span class="math inline">\hat{beta}_1</span> we obtain. In the derivation we use the assumption of <span class="math inline">y_i</span> being uncorrelated and the fact that the variance of a difference of uncorrelated random variables equals the sum of their variances.</p>
<p><span id="eq-simple-anova-var-beta1"><span class="math display">
\begin{align*}
Var(\hat{\beta}_1) &amp; = Var\left(\frac{1}{n_1}\sum_{i: x_i = 1} y_i - \frac{1}{n_0}\sum_{i: x_i = 0} y_i\right) \\
                   &amp; = Var\left(\frac{1}{n_1}\sum_{i: x_i = 1} y_i \right) + Var\left(\frac{1}{n_0}\sum_{i: x_i = 0} y_i\right) \\
                   &amp; = \frac{\sigma^2}{n_1} + \frac{\sigma^2}{n_0} \\
                   &amp; = \sigma^2 \left(\frac{1}{n_0} + \frac{1}{n_1}\right)
\end{align*}
\tag{5.6}</span></span></p>
<p>The variances of the two coefficients involve the unknown parameter <span class="math inline">\sigma^2</span>. From the expressions for the variances you will notice that the variances increase in <span class="math inline">\sigma^2</span>. This should make sense intuitively. <span class="math inline">\sigma^2</span> describes how much noise the data contains (random deviations from the regression line). Estimating the coefficients from noisy data will result in uncertain estimates (high variances).</p>
<p>In order to arrive to estimates the coefficient variances we need a way to estimate <span class="math inline">\sigma^2</span> from the data. Here we will take a theorem from mathematical statistics that says that</p>
<p><span id="eq-sigma-estimator"><span class="math display">
\hat{\sigma}^2 = \frac{1}{n - p} \text{RSS}
\tag{5.7}</span></span></p>
<p>is an unbiased estimator for <span class="math inline">\sigma</span>. In the above expression <span class="math inline">n</span> is the number of observations and <span class="math inline">p</span> is the number of coefficients in the model. RSS is the residual sum of squares <a href="03-Simple-Linear-Model.html#sec-ols-intro"><span>Section&nbsp;4.2</span></a>.</p>
<p><span class="math display">
E\hat{\sigma}^2 = \sigma
</span></p>
<p>Plugging in this estimator for <span class="math inline">\sigma^2</span> into <a href="#eq-simple-anova-var-beta0">Equation&nbsp;<span>5.5</span></a> and <a href="#eq-simple-anova-var-beta1">Equation&nbsp;<span>5.6</span></a> yields the following estimators for the variances of the model coefficients.</p>
<p><span class="math display">
\begin{align*}
Var(\hat{\beta}_0) = &amp; \frac{\hat{\sigma}^2}{n_0} \\
Var(\hat{\beta}_1) = &amp; \hat{\sigma}^2 \left(\frac{1}{n_0} + \frac{1}{n_1}\right)
\end{align*}
</span> Let us compare the two formulas with the standard errors from the <code>lm</code> output (printed here again for convinience).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = kid_score ~ 1 + mom_hs, data = kids)

Residuals:
   Min     1Q Median     3Q    Max 
-57.55 -13.32   2.68  14.68  58.45 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   77.548      2.059  37.670  &lt; 2e-16 ***
mom_hs        11.771      2.322   5.069 5.96e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19.85 on 432 degrees of freedom
Multiple R-squared:  0.05613,   Adjusted R-squared:  0.05394 
F-statistic: 25.69 on 1 and 432 DF,  p-value: 5.957e-07</code></pre>
</div>
</div>
<p>The number of children in the two groups are <span class="math inline">n_0 = 93</span> and <span class="math inline">n_1 = 341</span>. The number of observations is <span class="math inline">n = n_0 + n_1 = 434</span>. The number of coefficients in the model is <span class="math inline">p = 2</span>. We can compute the RSS by extracting the residuals from the model fit object (for example by using the <code>residuals</code> function).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(res <span class="sc">^</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 170261.2</code></pre>
</div>
</div>
<p>The estimate for <span class="math inline">\sigma^2</span> is therefore:</p>
<p><span class="math display">
\hat{\sigma}^2 = \frac{170261.2}{434 - 2} = 394.1231 \\
\hat{\sigma} = \sqrt{\hat{\sigma}^2} = 19.85
</span></p>
<p>You can find last value under <em>residual standard error</em> in the summary of the <code>lm</code> output above.</p>
<p>Now let us compute the estimated variances and standard deviations of the coefficients:</p>
<p><span class="math display">
\begin{align*}
Var(\hat{\beta}_0) &amp; = \frac{\hat{\sigma}^2}{n_0} = \frac{394.1}{93} = 4.23 \\
se(\hat{\beta}_0) &amp; = \sqrt{Var(\hat{\beta}_0)} = \sqrt{4.23} = 2.059 \\
Var(\hat{\beta}_1) &amp; = \hat{\sigma}^2 \left(\frac{1}{n_0} + \frac{1}{n_1}\right)  = 394.1 \left(\frac{1}{93} + \frac{1}{341}\right) = 5.39\\
se(\hat{\beta}_1) &amp; = \sqrt{Var(\hat{\beta}_1)} = \sqrt{5.39} = 2.32
\end{align*}
</span></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-Simple-Linear-Model.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Simple Linear Model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-Hypothesis-Testing-and-CI.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">A Simulation Study</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>