<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to linear regression analysis - 2&nbsp; Statistics Review</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-Simple-Linear-Model.html" rel="next">
<link href="./01-Introduction-to-R.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistics Review</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to linear regression analysis</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Setup</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Introduction-to-R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Statistics-Review.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistics Review</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-Simple-Linear-Model.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simple Linear Model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-probability" id="toc-sec-probability" class="nav-link active" data-scroll-target="#sec-probability"><span class="toc-section-number">2.1</span>  Probability</a></li>
  <li><a href="#sec-discrete-distributions" id="toc-sec-discrete-distributions" class="nav-link" data-scroll-target="#sec-discrete-distributions"><span class="toc-section-number">2.2</span>  Discrete distributions</a></li>
  <li><a href="#discrete-random-variables" id="toc-discrete-random-variables" class="nav-link" data-scroll-target="#discrete-random-variables"><span class="toc-section-number">2.3</span>  Discrete Random Variables</a></li>
  <li><a href="#expected-value" id="toc-expected-value" class="nav-link" data-scroll-target="#expected-value"><span class="toc-section-number">2.4</span>  Expected value</a>
  <ul class="collapse">
  <li><a href="#properties-of-the-expected-value" id="toc-properties-of-the-expected-value" class="nav-link" data-scroll-target="#properties-of-the-expected-value"><span class="toc-section-number">2.4.1</span>  Properties of the expected value</a></li>
  </ul></li>
  <li><a href="#variance" id="toc-variance" class="nav-link" data-scroll-target="#variance"><span class="toc-section-number">2.5</span>  Variance</a></li>
  <li><a href="#continuous-distributions" id="toc-continuous-distributions" class="nav-link" data-scroll-target="#continuous-distributions"><span class="toc-section-number">2.7</span>  Continuous Distributions</a>
  <ul class="collapse">
  <li><a href="#uniform-distributions" id="toc-uniform-distributions" class="nav-link" data-scroll-target="#uniform-distributions"><span class="toc-section-number">2.7.1</span>  Uniform distributions</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistics Review</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## First, load the tidyverse package</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## If the package is not installed, uncomment the next line and run the code chunk again</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages("tidyverse")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ ggplot2 3.4.2     ✔ purrr   1.0.1
✔ tibble  3.2.1     ✔ dplyr   1.1.1
✔ tidyr   1.3.0     ✔ stringr 1.5.0
✔ readr   2.1.4     ✔ forcats 1.0.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"lib.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-probability" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sec-probability"><span class="header-section-number">2.1</span> Probability</h2>
<p>Imagine a game where you flip a single coin once. The possible outcomes are then head (H) and tail (T). The set of all possible outcomes of the game is called the <em>sample</em> space of the experiment. We will denote this set with <span class="math inline">\(\Omega\)</span>. For a single coin toss game the sample space is <span class="math inline">\(\Omega = \{\text{heads}, \text{tails}\}\)</span>.</p>
<div id="def-probability" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.1 (Probability) </strong></span>Let <span class="math inline">\(\Omega\)</span> denote the sample space of a random experiment. Let <span class="math inline">\(A \subseteq \Omega\)</span> and <span class="math inline">\(B \subset \Omega\)</span> be two disjoint events (i.e.&nbsp;<span class="math inline">\(A \cap B = \varnothing\)</span>). Disjoint events are events that cannot occur simultaneously.</p>
<p><span class="math display">\[
\begin{align}
  &amp; P(A) \geq 0 \qquad \text{non-negativity}\\
  &amp; P(\Omega) = 1 \qquad  \text{unit measure} \\
  &amp; P(A \cup B) = P(A) + P(B) \qquad \text{additivity}
\end{align}
\]</span></p>
</div>
<div id="thm-probability-complement" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2.1 (Probability of complements) </strong></span>Let <span class="math inline">\(\Omega\)</span> be a sample space, let <span class="math inline">\(A \subseteq \Omega\)</span> be a subset of the sample space and let <span class="math inline">\(\bar{A} = \Omega \setminus A\)</span> be the complement of <span class="math inline">\(A\)</span> in <span class="math inline">\(\Omega\)</span>. Then the probability of the complement is given by:</p>
<p><span class="math display">\[
P(A) = 1 - P(\bar{A})
\]</span></p>
</div>
<div class="{proof}">
<p>For the proof note that <span class="math inline">\(A\)</span> and <span class="math inline">\(\bar{A}\)</span> are disjoint by definition (<span class="math inline">\(A \cap \bar{A} = \varnothing\)</span>). Using the additivity property of probability together with the unit probability of the sample space <span class="math inline">\(\Omega\)</span> from <a href="#def-probability">Definition&nbsp;<span>2.1</span></a> it follows that:</p>
<span class="math display">\[\begin{align}
    P(A \cup \bar{A}) = P(A) + P(\bar{A})
  \end{align}\]</span>
<span class="math display">\[\begin{align}
    P(A \cup \bar{A}) &amp; =  P(\Omega) \\
    P(A) + P(\bar{A}) &amp; = 1 \implies \\
    P(A) &amp; = 1 - P(\bar{A}).
  \end{align}\]</span>
</div>
<div id="exm-probability-weather" class="theorem example">
<p><span class="theorem-title"><strong>Example 2.1 (Weather forecast) </strong></span>Looking at the weather forecast for the next day you see that it will be raining (<span class="math inline">\(A\)</span>) with probability <span class="math inline">\(P(A) = 0.3\)</span>. The sample space is <span class="math inline">\(\Omega = \{A, \bar{A}\}\)</span> and the probability of not raining (<span class="math inline">\(\bar{A}\)</span>) is then <span class="math inline">\(P(\bar{A}) = 1 - 0.3 = 0.7\)</span>.</p>
</div>
<div id="exm-probability-dice" class="theorem example">
<p><span class="theorem-title"><strong>Example 2.2 (Dice) </strong></span>In a game where you roll a (6-sided) dice once the sample space is <span class="math inline">\(\Omega = \{1, 2, 3, 4, 5, 6\}\)</span>. Denote the outcome of a roll with <span class="math inline">\(X\)</span> and assume that the probability of each outcome is equal: <span class="math inline">\(P(X = i) = 1 / 6, i = 1,2,\ldots,6\)</span>. The probability of the event <span class="math inline">\(X = 1\)</span> is then <span class="math inline">\(P(X = 1) = 1/6\)</span>. The probability of the event “outcome is not one” is <span class="math inline">\(P(X \neq 1) = P(X &gt; 1) = 5 / 6.\)</span></p>
</div>
<p>See <span class="citation" data-cites="BERTSEKAS2008IntroductionProbability">Bertsekas and Tsitsiklis (<a href="references.html#ref-BERTSEKAS2008IntroductionProbability" role="doc-biblioref">2008</a>)</span> (Chapter 1) for a more thorough treatment of the subject.</p>
</section>
<section id="sec-discrete-distributions" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="sec-discrete-distributions"><span class="header-section-number">2.2</span> Discrete distributions</h2>
<div class="cell">

</div>
<p>When we presented the axioms of probability we mentioned the concept of a sample space and probability. For the sake of brevity we will skip almost all of the set theoretic foundation of probability measures and will directly introduce the concept of a random variable.</p>
<p>Let us go back to the roots of probability theory that date back at least to the 17th century and the study of games of chance (gambling) <span class="citation" data-cites="FREEDMAN2007Statistics">(<a href="references.html#ref-FREEDMAN2007Statistics" role="doc-biblioref">Freedman, Pisani, and Purves 2007, 248</a>)</span>. Almost all introductory text on probability theory start with an example of some simple game of chance. We will follow this example, because it is easy to understand a simple game and the mathematical concepts involved. Later we will see how we can apply the concepts developed here to an extremely broad range of problems.</p>
</section>
<section id="discrete-random-variables" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="discrete-random-variables"><span class="header-section-number">2.3</span> Discrete Random Variables</h2>
<p>Imagine that you are about to buy a lottery ticket that costs 1 EUR. Until you buy and scratch the ticket you don’t actually know how much you will win, but before you commit to the purchase you may wonder what winnings you should <em>expect</em>. Without knowing the <em>rules</em> of the lottery you would be completely in the dark about your prospects, so let us assume that you actually know how the lottery works.</p>
<p>From our point of view the rules of the game are completely determined by two things. The first one is the set of possible outcomes (the sample space) of the lottery and let’s assume that each ticket can win 0 EUR, 1 EUR or 2 EUR. Notice that the set of possible values is <em>finite</em> as there are only three possible outcomes. Let us write <span class="math inline">\(X\)</span> for the (yet unknown) winning from our lottery ticket. In lottery games the value of <span class="math inline">\(X\)</span> depends on some random mechanism (for example drawing numbered balls, spinning a wheel, etc.), therefore it is a <em>function</em> of the outcome of this random mechanism. We will call functions like <span class="math inline">\(X\)</span> <em>random variables</em>. For the most part we will not refer the underlying random mechanism and will simply focus on the distribution of the possible values of <span class="math inline">\(X\)</span>. The second part of the rules is how often winnings of 0 EUR, 1 EUR and 2 EUR occur when you repeatedly play the game. Obviously, a game where half of the tickets win 2 EUR is quite different from a game where only one out of 100 tickets wins 2 EUR.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-discrete-game-probabilities" class="anchored">

<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Table&nbsp;2.1:  Distribution of outcomes for two games of chance. Possible outcomes and probabilities for each outcome. </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Winnings(x) </th>
   <th style="text-align:right;"> P(x) </th>
   <th style="text-align:left;"> Winnings(y) </th>
   <th style="text-align:right;"> P(y) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0 EUR </td>
   <td style="text-align:right;"> 0.5 </td>
   <td style="text-align:left;"> 0 EUR </td>
   <td style="text-align:right;"> 0.5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 EUR </td>
   <td style="text-align:right;"> 0.3 </td>
   <td style="text-align:left;"> 1 EUR </td>
   <td style="text-align:right;"> 0.1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 EUR </td>
   <td style="text-align:right;"> 0.2 </td>
   <td style="text-align:left;"> 2 EUR </td>
   <td style="text-align:right;"> 0.3 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Let us focus on the first game with probabilities (0.5, 0.3 and 0.2) and develop some intuitive understanding of these quantities. You can think about the probabilities in Table @ref(tab:discrete-game-probabilities) as theoretical proportions in a sense that if you play the lottery 100 times you would expect to win nothing (0 EUR) in <em>about</em> 50 games, 1 EUR in <em>about</em> 30 games and 2 EUR in about <em>20</em> games. Notice that to <em>expect</em> 20 2-EUR wins out of 100 games is absolutely <em>not</em> the same as the statement that you <em>will</em> win 2 EUR in exactly 20 out of 100 games! To convince yourself look at @ref(tab:discrete-games-simulation) which presents the results of five simulated games with 100 tickets each. You can play with this and similar games by changing the number of tickets and the number of games in this <a href="https://feb-uni-sofia.shinyapps.io/econometrics2020/">simulation</a>. In the first game the player had 49 tickets that won nothing, but in the second game she had only 38 0-win tickets. When we say to expect 50 0-wins out of 100 tickets we mean that the number of observed (actually played) 0-wins will <em>vary</em> around 50. In neither of the five simulated games was the number of 0-wins exactly equal to 50 (this is also possible, though).</p>
<p>::: {.cell =‘{}’ anchor=‘table’ tab.align=‘center’} ::: {.cell-output-display}</p>

<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Simulation of five games with 100 tickets each. Number of tickets by outcome (0, 1, or 2 EUR) and average ticket win.</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> x = 0 </th>
   <th style="text-align:right;"> x = 1 </th>
   <th style="text-align:right;"> x = 2 </th>
   <th style="text-align:right;"> average ticket win </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Game 1 </td>
   <td style="text-align:right;"> 49 </td>
   <td style="text-align:right;"> 34 </td>
   <td style="text-align:right;"> 17 </td>
   <td style="text-align:right;"> 0.68 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Game 2 </td>
   <td style="text-align:right;"> 38 </td>
   <td style="text-align:right;"> 36 </td>
   <td style="text-align:right;"> 26 </td>
   <td style="text-align:right;"> 0.88 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Game 3 </td>
   <td style="text-align:right;"> 47 </td>
   <td style="text-align:right;"> 31 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:right;"> 0.75 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Game 4 </td>
   <td style="text-align:right;"> 49 </td>
   <td style="text-align:right;"> 26 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 0.76 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Game 5 </td>
   <td style="text-align:right;"> 62 </td>
   <td style="text-align:right;"> 23 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 0.53 </td>
  </tr>
</tbody>
</table>

<p>::: :::</p>
<p>The probabilities in <a href="#tbl-discrete-game-probabilities">Table&nbsp;<span>2.1</span></a> completely describe the two games. The functions that assigns a probability to each possible outcome <span class="math inline">\(p(x)\)</span> and <span class="math inline">\(p(y)\)</span> are called <em>probability mass functions</em>. These functions incorporate everything there is to know about our hypothetical games. While this knowledge will not guarantee you a profit from gambling, it enables you to compute the expected value of each ticket, the probability that none of your tickets will win, etc. An important property of the probability mass function is that it is always non-negative (no negative probabilities) and that the sum of the probabilities over all possible values is exactly <span class="math inline">\(1\)</span>.</p>
<div id="def-probability-mass-function" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.2 (Probability mass function) </strong></span>For a discrete random variable <span class="math inline">\(X\)</span> with possible values <span class="math inline">\(x_1,\ldots,x_K\)</span> a function <span class="math inline">\(p(x_i)\)</span> that assigns a probability to the possible values of <span class="math inline">\(X\)</span> is called a probability mass function.</p>
<p><span class="math display">\[
\begin{align}
  P(X = x_k) = p_k.
\end{align}
\]</span> The probabilities are real numbers in the interval <span class="math inline">\([0, 1]\)</span> and need to sum to 1 over all possible values.</p>
<span class="math display">\[\begin{align}
  p_k \geq 0\\
  \sum_{k = 1} ^ {K} p_k = 1.
\end{align}\]</span>
</div>
<p>Note that the set of <span class="math inline">\(K\)</span> possible values <span class="math inline">\(x_1,\ldots,x_K\)</span> is <em>finite</em>. The same definition can be used for infinite sets of possible values as long as these are <em>countably infinite</em> but we will skip this discussion.</p>
<div id="exm-probability-mass-function-games" class="theorem example">
<p><span class="theorem-title"><strong>Example 2.3 (Probability mass function) </strong></span>The first game in <a href="#tbl-discrete-game-probabilities">Table&nbsp;<span>2.1</span></a> has three possible outcomes: <span class="math inline">\(x_1 = 0, x_2 = 1, x_3 = 2\)</span>. The probability mass function is then</p>
<p><span class="math display">\[
p(x) = \begin{cases}
0.5 &amp; \text{if} \quad x = 0 \\
0.3 &amp; \text{if} \quad x = 1 \\
0.2 &amp; \text{if} \quad x = 2 \\
0 &amp; \text{otherwise}
\end{cases}
\]</span></p>
</div>
<p>A common visualization of the probability mass function is a barchart with the heights of the bars corresponding to the probability of each outcome.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> p)) <span class="sc">+</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="02-Statistics-Review_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- ::: {#exr-discrete-game} -->
<!-- ## Discrete probability -->
<!-- Consider a game of chance with the following probability mass function. -->
<!-- $$ -->
<!-- p(x) = \begin{cases} -->
<!-- 0.05 & \text{if} \quad x = -2 \\ -->
<!-- 0.20 & \text{if} \quad x = -1 \\ -->
<!-- 0.25 & \text{if} \quad x = 0 \\ -->
<!-- 0.5 & \text{if} \quad x = 1 \\ -->
<!-- 0 & \text{otherwise} -->
<!-- \end{cases} -->
<!-- $$ -->
<!-- - Plot ths PMF using a barchart -->
<!-- - Write down the corresponding CDF -->
<!-- ```{r} -->
<!-- ## ggplot -->
<!-- ``` -->
<!-- ```{r} -->
<!-- ## Select size = 20 values at random from the numbers 0, 1, 2, -->
<!-- ## with selection probabilities: 0.5, 0.3, 0.2 -->
<!-- sample(0:2, size = 20, prob = c(0.5, 0.3, 0.2), replace = TRUE) -->
<!-- ``` -->
<!-- ::: -->
<!-- ::: {def-cdf} -->
<!-- # Cumulative Distribution Function -->
<!-- Closely related to the probability mass function is the cumulative distribution function (CDF) which computes the probability for events of the type $X \leq x$. -->
<!-- ```{=tex} -->
<!-- \begin{align} -->
<!--     F(x) = \sum_{x_i \leq x} p(x_i). -->
<!--   \end{align} -->
<!-- ``` -->
<!-- ::: -->
<!-- ::: {exm-cdf-games} -->
<!-- # CDF for the lottery game -->
<!-- ```{=tex} -->
<!-- \begin{align} -->
<!--   P(X < 0) = 0 \\ -->
<!--   P(X < 1) & = \sum_{x_k < 1} p(x_k) = p(x_1) = 0.5. \\ -->
<!--   P(X \leq 1) & = \sum_{x_k \leq 1} p(x_k) = p(x_1) + p(x_2) = 0.5+ 0.3= 0.8\\ -->
<!--   P(X < 2) & = \sum_{x_k < 2} p(x_k) = p(x_1) + p(x_2) = 0.5+ 0.3= 0.8\\ -->
<!--   P(X \leq 2) & = \sum_{x_k \leq 2} p(x_k) = p(x_1) + p(x_2) + p(x_3) = 0.5+ 0.3+ 0.2= 1\\ -->
<!-- \end{align} -->
<!-- ``` -->
<!-- $$ -->
<!-- F(x) =  -->
<!-- \begin{cases} -->
<!--   0 & x < 0 \\ -->
<!--   0.5 & 0 \leq x < 1 \\ -->
<!--   0.8 & 1 \leq x < 2 \\ -->
<!--   1 & x \leq 2 \\ -->
<!--   1 & x > 2 -->
<!-- \end{cases} -->
<!-- $$ -->
<!-- ::: -->
</section>
<section id="expected-value" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="expected-value"><span class="header-section-number">2.4</span> Expected value</h2>
<p>Just as the descriptive statistics (average, empirical median, empirical quantiles, etc.) are useful for summarising a set of numbers we would like to be able to summarise distribution <em>functions</em>.</p>
<p>Imagine that you plan to buy 100 tickets from the first game in Table @ref(tab:discrete-game-probabilities). Based on the interpretation of probabilities as theoretical proportions you would <em>expect</em> that 50 of the tickets will win nothing, 30 of the tickets will bring you 1 EUR and 20 of the tickets will win 2 EUR. Thus you can write the expected winnings per ticket by summing the contributions of each ticket type:</p>
<p><span class="math display">\[\begin{align}
  \text{expected winnings} &amp; =
    \underbrace{\frac{50}{100} \times 0\text{ EUR}}_{0\text{ EUR tickets}} +
    \underbrace{\frac{30}{100} \times 1\text{ EUR}}_{1\text{ EUR tickets}} +
    \underbrace{\frac{20}{100} \times 2\text{ EUR}}_{2\text{ EUR tickets}} \\
    &amp; = 0.5 \times 0 \text{EUR} + 0.3 \times 1 \text{EUR} + 0.2 \times 2 \text{EUR} = 0.7\text{EUR}.
\end{align}\]</span>{eq-expected-value-game-1}</p>
<p>Note that the coefficients before the possible outcomes are simply their probabilities. Therefore in a game with 100 tickets you expect that each ticket will bring you <span class="math inline">\(0.7\)</span> EUR (on average). Just as with the probabilities, the expected values does not tell you that your average win per ticket <em>will</em> be 0.7 EUR. If you take a look at the five simulated games in Table @ref(tab:discrete-games-simulation) you will notice that the <em>realised</em> average ticket wins are <em>not</em> equal to 0.7 but they <em>vary</em> around it. You can think about the expected value as the <em>centre</em> of the distribution (see Figure @ref(fig:game-probabilities-plot) and <span class="citation" data-cites="FREEDMAN2007Statistics">Freedman, Pisani, and Purves (<a href="references.html#ref-FREEDMAN2007Statistics" role="doc-biblioref">2007</a>)</span>, pp.&nbsp;288). It is important to see that the expected value only depends on the probabilities and the possible values and it <em>does not</em> depend on the outcome of any particular game. Therefore it is a <em>constant</em> and not a random variable itself.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-Statistics-Review_files/figure-html/game-probabilities-plot-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Probabilities plot. The black vertical line depicts the expected value.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<!-- TODO: bridge -->
<p>Let us write the expected value in a more general way:</p>
<div id="def-expectation-discrete" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.3 (Expected Value) </strong></span>For discrite random variable <span class="math inline">\(X\)</span> with possible values <span class="math inline">\(x_1, x_2,\ldots,x_n\)</span> the weighted average of the possible outcomes: <span class="math display">\[\begin{align}
    E(X) = \sum_{i = 1} ^ {n} x_i p(x_i) (\#eq:expectation-discrete)
  \end{align}\]</span> is called the expected value of <span class="math inline">\(X\)</span>. Sometimes we will refer to the expected value as the mean of the distribution or the mean of the random variable following the distribution.</p>
</div>
<p>We introduced the expected value with an example of a game with 100 tickets in order to illustrate it. You should notice from <a href="#def-expectation-discrete">Definition&nbsp;<span>2.3</span></a> that the expected value is independent of the <em>number</em> of games played as it is a property of the probability mass function of the game.</p>
<div id="exr-expected-value-game-2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.1 (Expected Value) </strong></span>Let <span class="math inline">\(Y\)</span> be a game with possible winnings of -1, 0, and 2 EUR. The probabilities of these outcomes are <span class="math inline">\(P(x = -1) = 0.2, P(x = 0) = 0.7, P(x = 2) = 0.1\)</span>.</p>
<ul>
<li>Plot the PMF using a barchart</li>
<li>Calculate the expected winnings of this game using <a href="#def-expectation-discrete">Definition&nbsp;<span>2.3</span></a></li>
</ul>
<p>Play the game using the function <code>sample</code> (check its documentation either by typing <code>?sample</code> on the command line in R or by searching for it online). It selects <code>size</code> of the values speficied in <code>x</code> according to the probabilities given in <code>prob</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>), </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">10</span>, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">replace =</span> <span class="cn">TRUE</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  0  0  0 -1  0  0  0  0 -1  0</code></pre>
</div>
</div>
<p>Play the game a couple of times and look at the outcomes. Compute the average winnings using <code>mean</code> and compare the result with the expected value that you calculated in the previous step.</p>
</div>
<section id="properties-of-the-expected-value" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="properties-of-the-expected-value"><span class="header-section-number">2.4.1</span> Properties of the expected value</h3>
<p>In the following we list a few important properties of the expected value that we will use throughout the course. In the following let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be random variables with expected values <span class="math inline">\(E(X)\)</span> and <span class="math inline">\(E(Y)\)</span>.</p>
<div id="thm-expectation-linearity" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2.2 (Linearity of the Expected Value) </strong></span>Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be two random variables. Then the exected value of their sum equals the sum of their expected values.</p>
<p><span class="math display">\[\begin{align}
  E(X + Y) = E(X) + E(Y)
\end{align}\]</span></p>
</div>
<div id="thm-expectation-constant" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2.3 (The Expected Value of a Constant) </strong></span>The expected value of a constant equals the constant itself. Let <span class="math inline">\(a\)</span> be any fixed (not random) real number. Then its expected value is:</p>
<p><span class="math display">\[\begin{align}
  E(a) = a.
\end{align}\]</span></p>
</div>
<div id="thm-expectation-scaled" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2.4 (Expected value of a scaled random variable) </strong></span>Let <span class="math inline">\(X\)</span> be a random variable and let <span class="math inline">\(a\)</span> be any fixed (not random) real number. Then the expected value of <span class="math inline">\(aX\)</span> is:</p>
<p><span class="math display">\[\begin{align}
  E(aX) = a E(X)
\end{align}\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[\begin{align}
  E(aX) = \sum_{i = 1} ^ {n} a x_i p(x_i) = a \sum_{i = 1} ^ {n} x_i p(x_i) = aE(X).
\end{align}\]</span></p>
</div>
</section>
</section>
<section id="variance" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="variance"><span class="header-section-number">2.5</span> Variance</h2>
<p>Let us compare the two games in <a href="#tbl-discrete-game-probabilities">Table&nbsp;<span>2.1</span></a>. Both have the same sample space (set of possible outcomes) and both have the same expected winnings, see <span class="quarto-unresolved-ref">?eq-expected-value-game-1</span> and <span class="quarto-unresolved-ref">?eq-expected-value-game-2</span>. The games are not identical, though, because their probability distributions are different. If given the choice to play only one game, which one would you prefer?</p>
<p>The second game offers a higher probability to win the highest prize (2 EUR) at the cost of a lower probability for the middle prize (1 EUR). In other words it places a higher probability on <em>extreme</em> outcomes (outcomes that are far from the centre of the distribution, i.e.&nbsp;the expected value). A summary of a distribution that measures its spread (i.e.&nbsp;how likely are extreme values) is the variance:</p>
<div id="def-variance" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.4 (Variance) </strong></span>For a discrete random variable <span class="math inline">\(X\)</span> with possible outcomes <span class="math inline">\(x_1, x_2,\ldots,x_n\)</span> and probability function p(x) the variance is the expected quadratic deviation from the expected value of the distribution <span class="math inline">\(E(X)\)</span>.</p>
<p><span class="math display">\[\begin{align}
  Var(X) &amp; = E(X - E(X)) ^ 2 \\
         &amp; = \sum_{i = 1}  ^ n \left(x_i - E(X)\right) ^ 2 p(x_i)
\end{align}\]</span></p>
</div>
<div id="exm-variance-discrete" class="theorem example">
<p><span class="theorem-title"><strong>Example 2.4 (Variance) </strong></span>The variance of the first game (X) is:</p>
<p><span class="math display">\[\begin{align}
    Var(X) &amp; = \sum_{i = 1} ^ {3} (x_i - E(X)) ^ 2 p(x_i) \\
           &amp; = (x_1 - E(X)) ^ 2 p(x_i) + (x_2 - E(X)) ^ 2 p(x_2) + (x_3 - E(X)) ^ 2 p(x_3) \\
           &amp; = (\devxa) ^ 2 \times \pa + (\devxb) ^ 2 \times \pb + (\devxc) ^ 2 \times \pc \\
           &amp; = \varx.
  \end{align}\]</span></p>
</div>
<div id="exr-variance-discrete" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.2 </strong></span>Compute the variance of <span class="math inline">\(Y\)</span>, the second game described in Table <a href="#tbl-discrete-game-probabilities">Table&nbsp;<span>2.1</span></a>.</p>
</div>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span><span class="math inline">\(Var(Y) = \vary\)</span>.</p>
</div>
</section>
<div id="independence-random-variables">
<section id="independence-of-random-variables" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="independence-of-random-variables"><span class="header-section-number">2.6</span> Independence of Random Variables</h2>
<p>Two discrete random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> with possible values <span class="math inline">\(x_1,\ldots,x_K\)</span> and <span class="math inline">\(y_1,\ldots,y_L\)</span> are independent if for every <span class="math inline">\(k\)</span> and <span class="math inline">\(l\)</span>:</p>
<p><span class="math display">\[\begin{align}
  P(X = x_k, Y = y_l) = P(X = x_k)P(Y = y_l)
\end{align}\]</span></p>
</section>
</div>
<div id="thm-variance-sum-independent" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2.5 </strong></span>For two independent random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. <span class="math display">\[\begin{align}
  Var(X + Y) = Var(X) + Var(Y)
\end{align}\]</span></p>
<p>More generally, if <span class="math inline">\(X_i, i = 1,\ldots,n\)</span> are independent random variables, the variance of their sum is equal to the sum of their variances:</p>
<p><span class="math display">\[\begin{align}
Var\left(\sum_{i = 1}^{n} X_i\right) = \sum_{i = 1}^{n} Var(X_i).
\end{align}\]</span></p>
</div>
<!-- TODO: rename to variance-sum-independent -->
<p><a href="#thm-variance-sum-independent">Theorem&nbsp;<span>2.5</span></a> actually holds even for only uncorrelated variables. We will discuss the concept correlation later.</p>
<div id="thm-variance-scaled" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2.6 (Variance of a Scaled Random Variable) </strong></span>Let <span class="math inline">\(a \in \mathbf{R}\)</span> be a fixed (not random) real number and let <span class="math inline">\(X\)</span> be a random variable with variance <span class="math inline">\(Var(X)\)</span>.</p>
<p>The variance of <span class="math inline">\(aX\)</span> is given by:</p>
<p><span class="math display">\[\begin{align}
Var(aX) = a^2 Var(X).
\end{align}\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[\begin{align}
  Var(aX) &amp; = \sum_{k = 1} ^ K (ax_k - E(aX))^2 p(x_k) \\
          &amp; = \sum_{k = 1} ^ K a^2(x_k - E(X))^2 p(x_k) \\
          &amp; = a^2 \sum_{k = 1} ^ K a^2(x_k - E(X))^2 p(x_k) \\
          &amp; = a^2 Var(X).
\end{align}\]</span></p>
</div>
<p>Another useful formula for working with the variance is:</p>
<p>Often it will be easier to compute the variance using the following decomposition: <span class="math display">\[\begin{align}
  Var(X) &amp; = E(X - E(X))^2 \\
         &amp; = E\left(X^2 - 2XE(X) + E(X) ^ 2\right) \\
         &amp; = E(X^2) - E(2XE(X)) + E(E(X) ^ 2) \\
         &amp; = E(X^2) - 2 E(X)E(X) + E(X) ^ 2 \\
         &amp; = E(X^2) - E(X)^2 (\#eq:variance-expansion).
\end{align}\]</span></p>
<p>The proof above uses the fact that <span class="math inline">\(E(X)\)</span> is a constant and applies <a href="#thm-expectation-constant">Theorem&nbsp;<span>2.3</span></a> and <a href="#thm-expectation-scaled">Theorem&nbsp;<span>2.4</span></a>.</p>
<section id="continuous-distributions" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="continuous-distributions"><span class="header-section-number">2.7</span> Continuous Distributions</h2>
<section id="uniform-distributions" class="level3" data-number="2.7.1">
<h3 data-number="2.7.1" class="anchored" data-anchor-id="uniform-distributions"><span class="header-section-number">2.7.1</span> Uniform distributions</h3>
<p><span class="math display">\[\begin{align}
X \sim \text{Uniform}(a, b), \quad a,b \in \mathbb{R} \\
f(x) = \begin{cases}
\frac{1}{b - a} &amp; a \leq x \leq b\\
0 &amp; \text{otherwise}
\end{cases} \\
E(X) = \int_{a}^{b} f(x) dx = \frac{1}{2}(a + b) \\
Var(X) = \int_{a}^{b} \left(x - E(X)\right)^2 = \frac{1}{12}(b - a)^2 \\
SD(X) = \sqrt{Var(X)} = \frac{1}{\sqrt{12}}(b - a) \\
F(x) = \int_{-\infty}^{x} = \begin{cases}
0 &amp; x &lt; a \\
\frac{x - a}{b - a} &amp; a \leq x \leq b\\
1 &amp; x &gt; b
\end{cases}
\end{align}\]</span></p>
<p>For <span class="math inline">\(a = -1\)</span> and <span class="math inline">\(b = 1\)</span> the density of the uniform distribution is depicted in the following figure:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>unif_dens_plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> dunif, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">max =</span> <span class="dv">1</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">1000</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>unif_dens_plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-unif-dens" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="02-Statistics-Review_files/figure-html/fig-unif-dens-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2.1: Density function of the uniform distribution over [-1, 1].</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In order to select values at random from the uniform distribution with limits <span class="math inline">\(a = -1\)</span> and <span class="math inline">\(b = 1\)</span> we can use the <code>runif</code> function. The number of values selected is controlled by the <code>n</code> argument, while the parameters of the distribution are specified in <code>min</code> (<span class="math inline">\(a\)</span>) and <code>max</code> (<span class="math inline">\(b\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Select 5 values at randorm from the uniform distribution over [-1, 1]</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Print x</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.7801805 -0.5024699  0.2865454  0.1473476  0.3013221</code></pre>
</div>
</div>
<p>The following code plots the values in <code>x</code> as small lines over the x-axis (rug plot).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Code for illustration only</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>unif_sim <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>unif_dens_plt <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="fu">aes</span>(<span class="at">x =</span> x), <span class="at">data =</span> unif_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="02-Statistics-Review_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The area under the density function for an interval is the probability of occurrence of outcomes in this interval. It is easy to calculate the area under <a href="#fig-unif-dens">Figure&nbsp;<span>2.1</span></a> for the interval [-1, -0.2]. The hight of the density function is constant at <span class="math inline">\(1/2\)</span>. The length of the interval is 0.8, therefore the area of the rectangle is <span class="math inline">\(0.8 \cdot 1/2 = 0.4\)</span>.</p>
<p><span class="math display">\[
P(X &lt; -0.2) = 0.4
\]</span> You can also compute this probability using the <code>punif</code> function. By default it computes probabilities of the type <code>P(X &lt; x)</code>, where <code>x</code> is its first argument. Note that you also need to speficy the limits of the distribution ([-1, 1] in this case).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute the probability</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">punif</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4</code></pre>
</div>
</div>
<p>Earlier we used <code>rnorm</code> to select a couple of values at random from this distribution. Let us compare the <em>observed</em> proportion of values less than -0.2 to the theoretical probability.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Use &lt; to see which values in x are less than -0.2</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.7801805 -0.5024699  0.2865454  0.1473476  0.3013221</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE  TRUE FALSE FALSE FALSE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute the sample proportion in the simulated data</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="do">## This relies on the following conversion of the logical values</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="do">## TRUE -&gt; 1, FALSE -&gt; 0. This conversion happens under the hood </span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="do">## in the mean function</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2</code></pre>
</div>
</div>
<p>As an exercise, increase the number of games plated (<code>size</code> argument in <code>rnorm</code>) and compare the <em>observed</em> proportion and the probability.</p>
<!-- $$ -->
<!-- P(X > -0.2) = 1 - F(-0.2) -->
<!-- $$ -->
<!-- ```{r} -->
<!-- ## Compute the probability -->
<!-- 1 - punif(-0.2, min = -1, max = 1) -->
<!-- punif(-0.2, min = -1, max = 1, lower.tail = FALSE) -->
<!-- ## Compute the sample proportion in the simulated data -->
<!-- mean(unif_sim$x > -0.2) -->
<!-- ``` -->
<!-- $$ -->
<!-- P(-0.2 < X < 0.3) = F(0.3) - F(-0.2) -->
<!-- $$ -->
<!-- ```{r} -->
<!-- ## Probability -->
<!-- punif(1.4, min = -1, max = 1) - punif(-0.1, min = -1, max = 1) -->
<!-- ## Sample proportion in the simulation -->
<!-- mean(unif_sim$x < 0.3 & unif_sim$x > -0.2) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- sim_unif <- tibble( -->
<!--   x = runif(n = 50, min = -1, max = 1) -->
<!-- ) -->
<!-- sim_unif %>% -->
<!--   ggplot(aes(x = x)) + -->
<!--   geom_histogram(bins = 10) + -->
<!--   xlim(c(-1, 1)) -->
<!-- ``` -->
<!-- # Normal distributions -->
<!-- $$ -->
<!-- X \sim N(\mu, \sigma^2) \\ -->
<!-- f(x) = \frac{1}{\sigma \sqrt{2 \pi}} e^{-\frac{1}{2}\left(\frac{x - \mu}{\sigma}\right)^2}\\ -->
<!-- E(X) = \mu \\ -->
<!-- Var(X) = \sigma^2 \\ -->
<!-- SD(X) = \sqrt{\sigma^2} = \sigma -->
<!-- $$ -->
<!-- ```{r} -->
<!-- players_n <- 300 -->
<!-- games_n <- 16 -->
<!-- unif_games <- expand_grid( -->
<!--   game = 1:games_n, -->
<!--   player = 1:players_n -->
<!-- ) %>% -->
<!--   mutate( -->
<!--     ## When used in mutate, n() returns the number of rows in a group of obs -->

<!--     ## When the data is not grouped as here, it retuns the number of obs in the whole table -->
<!--     result = runif(n(), min = -1, max = 1) -->
<!--   ) %>% -->
<!--   bind_rows( -->
<!--     ## Add a initial values so that all players start with 0 -->
<!--     tibble( -->
<!--       player = 1:players_n, -->
<!--       game = as.integer(0), -->
<!--       result = 0, -->
<!--     ) -->
<!--   ) -->
<!-- unif_games <- unif_games %>% -->
<!--   ## Sort the data by player id and game id -->
<!--   arrange(player, game) %>% -->
<!--   ## Groups the data by player, because we want the running totals to be calculated for each -->
<!--   ## player separately -->
<!--   group_by(player) %>% -->
<!--   mutate( -->
<!--     running_total = cumsum(result) -->
<!--   ) -->
<!-- ## Illustration only -->
<!-- unif_games %>% -->
<!--   ggplot(aes(x = game, y = running_total, group = player)) + -->
<!--   geom_vline(xintercept = c(4, 8, 16), linetype = 2) + -->
<!--   geom_hline(yintercept = 0) + -->
<!--   geom_line(aes(color = player < 2, alpha = player < 2)) + -->
<!--   scale_color_manual(values = c("skyblue4", "firebrick4")) + -->
<!--   scale_alpha_manual(values = c(1 / 5, 1)) + -->
<!--   scale_x_continuous("Game number", breaks = c(0, 4, 8, 12, 16)) + -->
<!--   theme(legend.position = "none") + -->
<!--   labs(y = "Running Total") -->
<!-- ``` -->
<!-- ```{r} -->
<!-- unif_games %>% -->
<!--   filter(game == 4) %>% -->
<!--   ggplot(aes(x = running_total)) + -->
<!--   geom_density() + -->
<!--   labs(title = "Running total distribution at the 4-th game") + -->
<!--   labs( -->
<!--     x = "Running total" -->
<!--   ) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- unif_games %>% -->
<!--   filter(game == 16) %>% -->
<!--   ggplot(aes(x = running_total)) + -->
<!--   geom_density() + -->
<!--   labs(title = "Running total distribution at the 16-th game") + -->
<!--   labs( -->
<!--     x = "Running total" -->
<!--   ) -->
<!-- ``` -->
<!-- # Statistical tests -->
<!-- | Истина/Решение | Осъден | Неосъден | -->
<!-- |----------------|--------|----------| -->
<!-- | Виновен        |        | X        | -->
<!-- | Невинен        | X      |          | -->
<!-- $$ -->
<!-- H_0: \mu = a \\ -->
<!-- H_1: \mu \neq a -->
<!-- $$ -->
<!-- $$ -->
<!-- t = \frac{\overline{x} - a}{S_x / \sqrt{n}} -->
<!-- $$ -->
<!-- The t-statistic follows a t-distribution with $n - 1$ degrees of freedom. -->
<!-- ```{r} -->
<!-- mu_0 <- 0 -->
<!-- B <- 2000 -->
<!-- n <- 300 -->
<!-- sim_test <- expand.grid( -->
<!--   experiment_id = 1:B, -->
<!--   obs_id = 1:n -->
<!-- ) %>% -->
<!--   mutate( -->
<!--     x = rnorm(n = n(), mean = mu_0, sd = 1) -->
<!--   ) %>% -->
<!--   group_by(experiment_id) %>% -->
<!--   summarise( -->
<!--     mean_x = mean(x), -->
<!--     sd_x = sd(x), -->
<!--     t_stat = (mean_x - mu_0) / (sd_x / sqrt(n)) -->
<!--   ) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- mean(sim_test$t_stat < -2) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- sim_test %>% -->
<!--   ggplot(aes(x = t_stat)) + -->
<!--   geom_density() + -->
<!--   geom_vline(xintercept = -2, lty = 2) + -->
<!--   geom_vline(xintercept = 2, lty = 2) -->
<!-- ``` -->


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-BERTSEKAS2008IntroductionProbability" class="csl-entry" role="doc-biblioentry">
Bertsekas, Dimitri P., and John N. Tsitsiklis. 2008. <em>Introduction to Probability</em>. 2nd ed. Optimization and Computation Series. <span>Belmont</span>: <span>Athena scientific</span>.
</div>
<div id="ref-FREEDMAN2007Statistics" class="csl-entry" role="doc-biblioentry">
Freedman, David, Robert Pisani, and Roger Purves. 2007. <em>Statistics</em>. 4th ed. <span>New York</span>: <span>W.W. Norton &amp; Co</span>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01-Introduction-to-R.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-Simple-Linear-Model.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simple Linear Model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>